<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>200m æˆç¸¾ä¸Šå‚³æ¸¬è©¦é </title>
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; margin: 40px; }
    label { display: block; margin-top: 10px; }
    button { margin-top: 20px; padding: 8px 20px; }
    #msg { margin-top: 20px; font-weight: bold; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h2>ğŸƒâ€â™‚ï¸ 200m æˆç¸¾ä¸Šå‚³æ¸¬è©¦é </h2>

  <form id="uploadForm">
    <label>æ—¥æœŸï¼š<input type="date" name="date" required></label>
    <label>ç·¨è™Ÿï¼š<input type="text" name="number" required></label>
    <label>é¸æ‰‹ï¼š<input type="text" name="name" required></label>
    <label>æˆç¸¾ï¼š<input type="text" name="result" required></label>
    <button type="submit">é€å‡ºè³‡æ–™</button>
  </form>

  <div id="msg"></div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyP-GBcmCgArvCZ8TElO5Ea8W-uRS3P3Ngx_gc3aDfqW03rNakdyCUgIW43dbpvZjZP/exec"; // âœ… æ”¹æˆä½ çš„ Web App URL

    document.getElementById('uploadForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const msgBox = document.getElementById('msg');
      msgBox.style.color = "black";
      msgBox.textContent = "â³ è³‡æ–™é€å‡ºä¸­...";

      try {
        const formData = new FormData(this);
        const response = await fetch(GAS_URL, {
          method: 'POST',
          body: formData
        });

        const text = await response.text();
        let json;
        try {
          json = JSON.parse(text);
        } catch (err) {
          msgBox.style.color = "red";
          msgBox.textContent = "âŒ å›å‚³é JSONï¼š\n" + text;
          return;
        }

        if (json.status === 'success') {
          msgBox.style.color = "green";
          msgBox.textContent = "âœ… æˆåŠŸï¼\n" + json.message + "\nä½¿ç”¨è€…ï¼š" + json.user + "\næ™‚é–“ï¼š" + json.timestamp;
          this.reset(); // é€å‡ºæˆåŠŸå¾Œæ¸…ç©ºè¡¨å–®
        } else {
          msgBox.style.color = "red";
          msgBox.textContent = "âŒ å¤±æ•—ï¼š\n" + json.message;
        }

      } catch (err) {
        msgBox.style.color = "red";
        msgBox.textContent = "âš ï¸ ç¶²è·¯æˆ–æ¬Šé™éŒ¯èª¤ï¼š\n" + err.message + "\nè«‹ç¢ºä¿ Web App å·²å…è¨±åŒ¿åè¨ªå•ã€‚";
      }
    });
  </script>
</body>
</html>
